/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.agent-sessions-viewer {

	flex: 1 1 auto;
	height: 100%;
	min-height: 0;

	.monaco-scrollable-element {
		padding: 0 6px;
	}

	.monaco-list-row {
		border-radius: 6px;
	}

	/* Hide focus outlines on mouse click, preserve for keyboard navigation */
	&.mouse-focused .monaco-list-row.focused,
	&.mouse-focused .monaco-list-row.focused.selected {
		outline: none !important;
	}

	.monaco-list-row .force-no-twistie {
		display: none !important;
	}

	.monaco-list-row.selected .agent-session-details-row {
		color: unset;

		.rendered-markdown {
			a {
				color: unset;
			}
		}
	}

	.monaco-list:focus .monaco-list-row.selected .agent-session-details-row {
		.agent-session-diff-container {
			.agent-session-diff-added,
			.agent-session-diff-removed {
					color: unset;
			}
		}
	}

	.monaco-list-row.selected .agent-session-title {
		color: unset;
	}

	.monaco-list-row.selected .agent-session-status {
		color: unset;
	}

	.monaco-list:not(:focus) .monaco-list-row.selected .agent-session-details-row {
		color: var(--vscode-descriptionForeground);
	}

	.monaco-list-row .agent-session-title-toolbar {
		/* for the absolute positioning of the toolbar below */
		position: relative;
		height: 16px;
		display: none;

		.monaco-toolbar {
			/* this is required because the overal height (including the padding needed for hover feedback) would push down the title otherwise */
			position: relative;
			right: 0;
			top: 0;
		}
	}

	/* On hover or keyboard focus: show toolbar, hide status */
	.monaco-list-row:hover,
	&:not(.mouse-focused) .monaco-list-row.focused {

		.agent-session-title-toolbar {
			display: block;
		}

		.agent-session-status {
			display: none;
		}
	}

	.agent-session-item {
		display: flex;
		flex-direction: row;
		padding: 4px 6px;

		&.archived {
			color: var(--vscode-descriptionForeground);
		}

		.agent-session-main-col,
		.agent-session-title-row,
		.agent-session-details-row {
			flex: 1;
			min-width: 0;
		}

		.agent-session-icon-col {
			display: flex;
			align-items: flex-start;
			line-height: 16px;

			.agent-session-icon {
				flex-shrink: 0;
				font-size: 12px;
				width: 14px;
				height: 14px;
				display: flex;
				align-items: center;
				justify-content: center;

				&.codicon.codicon-session-in-progress {
					color: var(--vscode-textLink-foreground);
				}

				&.codicon.codicon-error {
					color: var(--vscode-errorForeground);
				}

				&.codicon.codicon-report {
					color: var(--vscode-textLink-foreground);
				}

				&.codicon.codicon-circle-filled {
					color: var(--vscode-textLink-foreground);
				}

				&.codicon.codicon-circle-small-filled {
					color: var(--vscode-agentSessionReadIndicator-foreground);
				}
			}
		}

		.agent-session-main-col {
			padding-left: 6px;
		}

		.agent-session-title-row,
		.agent-session-details-row {
			display: flex;
			align-items: center;
		}

		.agent-session-title-row {
			line-height: 16px;
			padding-bottom: 2px;
		}

		.agent-session-details-row {
			gap: 4px;
			font-size: 11px;
			line-height: 14px;
			max-height: 14px;
			color: var(--vscode-disabledForeground);

			.rendered-markdown {
				p {
					display: flex;
					align-items: center;
					margin: 0;

					> span.codicon {
						margin-right: 2px;
					}
				}

				a {
					color: var(--vscode-descriptionForeground);
				}
			}

			.agent-session-diff-container,
			.agent-session-badge {
				font-weight: 500;
				font-variant-numeric: tabular-nums;
				overflow: hidden;
			}

			.agent-session-diff-container {
				display: flex;
				gap: 4px;

				&:not(.has-diff) {
					display: none;
				}

				.agent-session-diff-added {
					color: var(--vscode-chat-linesAddedForeground);
				}

				.agent-session-diff-removed {
					color: var(--vscode-chat-linesRemovedForeground);
				}
			}

			.agent-session-separator {
				display: none;

				&.has-separator {
					display: inline;

					&::before {
						content: '\00B7';
					}
				}
			}

			.agent-session-badge {

				p {
					overflow: hidden;
				}

				&:not(.has-badge) {
					display: none;
				}

				.codicon {
					font-size: 11px;
				}
			}
		}

		.agent-session-title,
		.agent-session-description {
			/* push other items to the end */
			flex: 1;
			overflow: hidden;
			white-space: nowrap;
			margin-right: 16px;
			mask-image: linear-gradient(to right, black calc(100% - 32px), transparent);
			-webkit-mask-image: linear-gradient(to right, black calc(100% - 32px), transparent);
		}

		.agent-session-title {
			font-size: 12px;
			color: var(--vscode-descriptionForeground);
		}

		.agent-session-status {
			display: flex;
			align-items: center;
			font-variant-numeric: tabular-nums;
			font-size: 11px;
			color: var(--vscode-disabledForeground);
			white-space: nowrap;

			.agent-session-status-provider-icon {
				font-size: 11px;
				margin-right: 4px;

				&.hidden {
					display: none;
				}
			}
		}
	}

	.agent-session-section {
		display: flex;
		align-items: center;
		font-size: 11px;
		font-weight: 500;
		color: var(--vscode-descriptionForeground);
		/* align with session item padding */
		padding: 0 6px;

		.agent-session-section-label {
			flex: 1;
		}

		.agent-session-section-toolbar {
			/* for the absolute positioning of the toolbar below */
			position: relative;

			.monaco-toolbar {
				/* this is required because the overal height (including the padding needed for hover feedback) would push down the label otherwise */
				position: absolute;
				right: 0;
				top: 0;
				display: none;
			}
		}
	}

	.monaco-list-row:hover .agent-session-section .agent-session-section-toolbar,
	.monaco-list-row.focused .agent-session-section .agent-session-section-toolbar {
		width: 22px;

		.monaco-toolbar {
			display: block;
		}
	}

	.monaco-list:focus .monaco-list-row.focused.selected .agent-session-section-label,
	.monaco-list:focus .monaco-list-row.selected .agent-session-section-label {
		color: var(--vscode-list-activeSelectionForeground);
	}

	.monaco-list:not(:focus) .monaco-list-row.selected .agent-session-section-label {
		color: var(--vscode-list-inactiveSelectionForeground);
	}
}
